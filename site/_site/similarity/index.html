<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<meta http-equiv="x-ua-compatible" content="ie=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<link href='https://fonts.googleapis.com/css?family=Open+Sans:400,300,700,800,600' rel='stylesheet' type='text/css'>
	<link href='https://fonts.googleapis.com/css?family=Muli:400,300' rel='stylesheet' type='text/css'>

    <!-- Include jQuery Mobile stylesheets -->
    <link rel="stylesheet" href="https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css">

    <!-- Include the jQuery library -->
    <script src="https://code.jquery.com/jquery-1.11.3.min.js"></script>

    <!-- Include the jQuery Mobile library -->
    <script src="https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>

    <!-- Listen -->
    <link rel="stylesheet" href="http://localhost:4000/assets/css/main.css">
    <script src="http://localhost:4000/assets/js/main.js"></script>

</head> 


<body>

<div data-role='page' id='id-similarity'>






<div data-role="header">

<a 
    class='ui-btn-left ui-btn ui-btn-inline ui-mini
           ui-corner-all ui-btn-icon-left ui-icon-carat-l back'>
    Previous
</a>

<h1 class='title'></h1>

<a 
    class='ui-btn-right ui-btn ui-btn-inline ui-mini
           ui-corner-all ui-btn-icon-right ui-icon-carat-r next'>
    Next
</a>
</div>

<!-- Popup window if all listener tries to move on before listening to all samples -->
<div data-role="popup" class="listen-to-all-samples-popup" data-position-to="window" data-transition="turn">
    <p>Please listen to all samples before moving on</p>
</div>

<div data-role="popup" class="submission-wait-popup" data-position-to="window" data-transition="turn">
    <p>Please wait for this page to redirect...</p>
</div>

<!-- Popup window for submissions -->
<div data-role='popup'
     data-position-to='window'
     class='ui-corner-all ui-popup ui-body-a ui-overlay-shadow submit-popup'
     data-theme='b'
     data-dismissible="false"
     >

<form method="post"
      action="https://api.staticman.net/v2/entry/CVSSP/perceptual-study-source-separation/gh-pages"
      class='submit-form'
      >

<h2>Thank you, please submit your data:</h2>

<input name="options[slug]" type="hidden" value='similarity'>
<input name="options[redirect]" type="hidden" value='http://localhost:4000/'>

<input name='fields[name]'
       value='My name'
       type='text'
>

<input name='fields[experiment_id]'
       value='similarity'
       type='hidden'
>

<input type='submit'
       value='Submit'
       >

<input type='button'
       value='Cancel'
       class='cancel'
       >
</form>
</div>

<!-- Main layout -->
<div data-role="main" class="ui-content">




<div class='mushra-container'>

<button class="mushra-reference" data-inline="true">Reference</button>
<button class="mushra-stop" data-inline="true">Stop</button>


<table class='similarity-table'>
<tr>
<th class='left-label'>Dissimilar</th>
<th class='right-label'>Similar</th>
</tr>
</table>


<div class="mushra-slider-container" data-role="ui-content"></div>

</div>

</div>

<!-- JS for interface instantiation -->
<script type="text/javascript">

$('#id-similarity').on('pageinit', function(e) {
 
    // Show loading spinner when user clicks submit
    $activePage ('.submit-form').on ('submit', function(e){
        $.mobile.loading('show');
    });

    $activePage ('.submit-form .cancel').on ('click', function(e) {
        $activePage ('.submit-popup').popup("close");
    });
});

var testInterface = null;

$('#id-similarity').on('pageshow', function(e) {

    var config = JSON.parse('{"continuous_playback":true,"loop_playback":true,"randomise_slider_handle":true,"randomise_sounds_within_page":true,"randomise_pages":true,"show_number_on_slider":true,"must_play_all_samples_to_continue":false,"back_button_can_exit_test":true,"allow_submission":false,"add_consistency_check":true,"labels":["Dissimilar","Similar"],"pages":[{"name":"Set 1","reference_url":"sounds/dog1.wav","sounds":[{"name":"Ref","url":"sounds/dog1.wav"},{"name":2,"url":"sounds/dog2.wav"},{"name":3,"url":"sounds/dog3.wav"}]},{"name":"Set 2","reference_url":"sounds/dog4.wav","sounds":[{"name":"Ref","url":"sounds/dog4.wav"},{"name":5,"url":"sounds/dog5.wav"},{"name":6,"url":"sounds/dog6.wav"}]}]}');

    if (config != null & e.type == 'pageshow')
    {
        $activePage ('.next').off();
        $activePage ('.back').off();

        config.siteURL = "http://localhost:4000";
        config.nextURL = 'http://localhost:4000/';

        var layout = 'similarity';

        if (layout == 'mushra' || layout == 'similarity')
        {
            testInterface = new Mushra (config);
        }
    }

});

</script>

</div>
</body>
</html>
